@page
@model FitTrackPro.Pages.Workouts.HistoryModel
@{
    ViewData["Title"] = "Workout History";
}
<partial name="_WorkoutNav" />
<h1>@ViewData["Title"]</h1>

@if (Model.SessionHistory != null && Model.SessionHistory.Any())
{
    foreach (var session in Model.SessionHistory.OrderByDescending(s => s.StartTime))
    {
        // 1. Improve card design: Add shadow-sm, rounded-3 (rounded corners), border-0 (remove border to emphasize shadow)
                <div class="card mb-4 rounded-3 shadow-sm border-0">

                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                    @session.StartTime.ToString("dddd, dd MMMM yyyy")
                        </h5>
                        <span class="badge bg-primary fs-6" style="min-width: 150px;">
                            Total Volume: @Model.SessionTotalVolumes[session.Id].ToString("N0") kg
                        </span>
                @if (session.TotalCaloriesBurned.HasValue && session.TotalCaloriesBurned > 0)
                {
                                            <span class="badge bg-danger fs-6" style="min-width: 150px;">
                                                Calories: @session.TotalCaloriesBurned.Value.ToString("N0") kcal
                                            </span>
                }
                                    </div>

                    </div>

                    <div class="card-body">
                @if (session.SessionLogs != null && session.SessionLogs.Any())
                {
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>Exercise</th>
                                            <th>Set</th>
                                            <th>Weight (kg)</th>
                                            <th>Reps</th>
                                            <th>Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                            @foreach (var log in session.SessionLogs)
                            {
                                var exercise = Model.GetExerciseById(log.ExerciseId);
                                                <tr>
                                                    <td>@(exercise?.Name ?? "Unknown Exercise")</td>
                                                    <td>@log.SetNumber</td>
                                                    <td>@log.Weight?.ToString("G29")</td>
                                                    <td>@log.Reps</td>
                                                    <td>@log.Notes</td>
                                                </tr>
                            }
                                    </tbody>
                                </table>
                }
                else
                {
                                <p class="text-muted">No details were logged for this session.</p>
                }
                    </div>
                
    }
}
else
{
        <p>You have no workout history yet. Go start a session!</p>
}